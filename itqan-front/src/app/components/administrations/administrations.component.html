<div class=" p-2 m-2 bg-white ">
    <div class="flex p-1 bg-blue-200 mb-1"><svg xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 512 640"
            enable-background="new 0 0 512 512" xml:space="preserve" width="20px" height="30px">
            <g>
                <path
                    d="M75.4,125h110.2c7.8,0,14.1-6.3,14.1-14.1c0-7.8-6.3-14.1-14.1-14.1H75.4c-7.8,0-14.1,6.3-14.1,14.1   C61.3,118.7,67.6,125,75.4,125z" />
                <path
                    d="M75.4,203.7h222.1c7.8,0,14.1-6.3,14.1-14.1c0-7.8-6.3-14.1-14.1-14.1H75.4c-7.8,0-14.1,6.3-14.1,14.1   C61.3,197.4,67.6,203.7,75.4,203.7z" />
                <path
                    d="M75.4,282.4h222.1c7.8,0,14.1-6.3,14.1-14.1c0-7.8-6.3-14.1-14.1-14.1H75.4c-7.8,0-14.1,6.3-14.1,14.1   C61.3,276.1,67.6,282.4,75.4,282.4z" />
                <path
                    d="M182,332.8H75.4c-7.8,0-14.1,6.3-14.1,14.1c0,7.8,6.3,14.1,14.1,14.1H182c7.8,0,14.1-6.3,14.1-14.1   C196.1,339.2,189.8,332.8,182,332.8z" />
                <path
                    d="M148.5,411.5H75.4c-7.8,0-14.1,6.3-14.1,14.1c0,7.8,6.3,14.1,14.1,14.1h73.1c7.8,0,14.1-6.3,14.1-14.1   C162.7,417.8,156.3,411.5,148.5,411.5z" />
                <path
                    d="M494.7,177.7c-17-17.4-45.4-22-65.3-3.4l-58.5,58.5V117.3c0-3.7-1.5-7.3-4.1-10L265.6,6.1c-2.6-2.6-6.2-4.1-10-4.1H44.4   C21,2,2,21,2,44.3v423.3C2,491,21,510,44.4,510h284.2c23.3,0,42.3-19,42.3-42.3v-97.5L498.1,243   C515.2,225.9,513.7,196.6,494.7,177.7z M322.7,103.2h-53l0-53L322.7,103.2z M342.7,467.7c0,7.8-6.3,14.1-14.1,14.1H44.4   c-7.8,0-14.1-6.3-14.1-14.1V44.3c0-7.8,6.3-14.1,14.1-14.1h197.2l0,87c0,7.8,6.3,14.1,14.1,14.1h87v129.8L219.5,384.3   c-1.9,1.9-3.2,4.3-3.8,6.9l-13.9,62.6c-1,4.7,0.4,9.6,3.8,13c4,3.8,8.4,4.6,13,3.8l62.6-13.9c2.6-0.6,5-1.9,6.9-3.8l54.5-54.5   V467.7z M478.1,223.1l-207,207l-36.9,8.2l8.2-36.9l207-207c6.5-6.2,17.4-4.3,25.4,3.4C482.6,205.5,484.1,217.1,478.1,223.1z" />
            </g>
        </svg>
        <h6 class="mx-1"> اضافة الادارات والاقسام</h6>
    </div>
    <p-toast></p-toast>
    <p-confirmDialog></p-confirmDialog>
    <form class="w-full" [formGroup]="departmentsForm">
        <div class="flex justify-end">
            <button (click)="showDialog()"
                class="mx-3 block text-white bg-blue-800 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded text-sm px-3 py-1.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"
                type="button">
                اضافة ادارة
            </button>
        </div>
        @for (item of administrations!; track $index) {
        <div class="grid grid-cols-12 px-3 ">
            <div class="col-span-12 bg-blue-500 flex border ">
                <div class="w-full text-white p-1"> {{item.name}} <span class="text-xs ms-5">(اضغط علي علامة + لاضافة
                        الاقسام)</span></div>
                <div class="flex">
                    <svg (click)="confirmdeletAdminstration($event,item.id)" xmlns="http://www.w3.org/2000/svg"
                        fill="none" viewBox="0 0 24 24" stroke-width="1" stroke="red" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" />
                    </svg>
                    <svg (click)="showAdminstrationEditDialog(item)" xmlns="http://www.w3.org/2000/svg" fill="none"
                        viewBox="0 0 24 24" stroke-width="1.5" stroke="#1E429F" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" />
                    </svg>
                </div>
            </div>

            <div class="col-span-12 flex bg-white m-0 p-0 ">

                <div class="w-4/12 flex border border border-gray-200 items-center px-1">
                    <svg fill="green" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 "
                        (click)="addDeparment(item.id)" xmlns:xlink="http://www.w3.org/1999/xlink"
                        viewBox="0 0 45.402 45.402" xml:space="preserve">
                        <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                        <g id="SVGRepo_iconCarrier">
                            <g>
                                <path
                                    d="M41.267,18.557H26.832V4.134C26.832,1.851,24.99,0,22.707,0c-2.283,0-4.124,1.851-4.124,4.135v14.432H4.141 c-2.283,0-4.139,1.851-4.138,4.135c-0.001,1.141,0.46,2.187,1.207,2.934c0.748,0.749,1.78,1.222,2.92,1.222h14.453V41.27 c0,1.142,0.453,2.176,1.201,2.922c0.748,0.748,1.777,1.211,2.919,1.211c2.282,0,4.129-1.851,4.129-4.133V26.857h14.435 c2.283,0,4.134-1.867,4.133-4.15C45.399,20.425,43.548,18.557,41.267,18.557z">
                                </path>
                            </g>
                        </g>
                    </svg>
                    <div class="">
                        <input type="text" formControlName="name" placeholder="ادخل اسم القسم" pInputText
                            class="text-sm  w-full border-0 md:col-span-5  mt-1 px-4 bg-gray-60" />

                    </div>
                </div>
                <div class="w-2/12 border border-gray-200 ">
                    <input type="text" formControlName="code" placeholder="ادخل رقم القسم" pInputText
                        class="text-sm w-full border-0 md:col-span-5 h-8 mt-1 px-4 bg-gray-60" />
                </div>
                <div class="w-2/12 border border-gray-200 ">
                    <input type="text" formControlName="transfer_number" placeholder="ادخل رقم التحويلة" pInputText
                        class="text-sm w-full border-0 md:col-span-5 h-8 mt-1 px-4 bg-gray-60" />
                </div>
            </div>
            @for (department of item.departments; track $index) {
            <div class=" verticalline pt-8 col-span-12 flex items-center mx-3">
                <hr class="w-8 bg-black ">
                <svg fill="#4285F4" width="12px" height="12px" viewBox="0 0 256 256" id="Flat"
                    xmlns="http://www.w3.org/2000/svg">
                    <path d="M232,128A104,104,0,1,1,128,24,104.12041,104.12041,0,0,1,232,128Z" />
                </svg>
                <div
                    class="w-full py-1  px-2 border-0 bg-blue-200 md:col-span-5 h-8 mt-1 px-4 bg-gray-60 my-3 flex justify-between">
                    <span>{{department.name}}</span>
                    <div class="flex">
                        <svg (click)="confirmDeleteDeparment($event,department.id)" xmlns="http://www.w3.org/2000/svg"
                            fill="none" viewBox="0 0 24 24" stroke-width="1" stroke="red" class="w-6 h-6">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" />
                        </svg>
                        <svg (click)="showDepartmentEditDialog(department.id,item.id)"
                            xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                            stroke="#1E429F" class="w-6 h-6">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" />
                        </svg>
                    </div>
                </div>
            </div>
            }
        </div>
        }
        <!-- {{departmentsForm.value | json}} -->
    </form>
</div>
<p-dialog header="اضافة ادارة جديدة" [(visible)]="visible" [modal]="true" [style]="{ width: '30rem' }"
    [breakpoints]="{ '900px': '80vw', '375px': '90vw' }">
    <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
        <div class="p-4 md:p-5">
            <form class="space-y-4" [formGroup]="administrationForm">
                <div>
                    <label for="name" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">
                        اسم الادارة</label>
                    <input type="text" name="name" id="name" formControlName="name"
                        class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white"
                        placeholder="" required />
                </div>
                <button type="submit" (click)="addAdministration()"
                    class="w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">
                    حفظ</button>
            </form>
        </div>
    </div>
</p-dialog>
<p-dialog header="تعديل القسم" [(visible)]="visibleDepartmentEditForm" [modal]="true" [style]="{ width: '30rem' }"
    [breakpoints]="{ '900px': '80vw', '375px': '90vw' }">
    <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
        <div class="p-4 md:p-5">
            <form class="space-y-4" [formGroup]="departmentsForm">
                <div>
                    <label for="name" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">
                        اسم القسم</label>
                    <input type="text" name="name" id="name" formControlName="name"
                        class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white"
                        placeholder="" required />
                    <input type="text" name="name" id="name" formControlName="code"
                        class="my-1 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white"
                        placeholder="رقم القسم" required />
                    <input type="text" name="name" id="name" formControlName="transfer_number"
                        class=" mt-1bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white"
                        placeholder="رقم التحويلة" required />
                </div>
                <button type="submit" (click)="updateDepartment()"
                    class="w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">
                    حفظ</button>
            </form>
        </div>
    </div>
</p-dialog>
<p-dialog header="تعديل القسم" [(visible)]="visibleAdminstrationEditForm" [modal]="true" [style]="{ width: '30rem' }"
    [breakpoints]="{ '900px': '80vw', '375px': '90vw' }">
    <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
        <div class="p-4 md:p-5">
            <form class="space-y-4" [formGroup]="administrationForm">
                <div>
                    <label for="name" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">
                        اسم القسم</label>
                    <input type="text" name="name" id="name" formControlName="name"
                        class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white"
                        placeholder="" required />
                </div>
                <button type="submit" (click)="updateAdminstration()"
                    class="w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">
                    حفظ</button>
            </form>
        </div>
    </div>
</p-dialog>
<!-- {{administrationForm.value | json}} -->
<!-- {{departmentsForm.value | json}} -->